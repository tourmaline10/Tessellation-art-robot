<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>敷き詰めアートロボット</title>
<style>
  body {
    font-family: sans-serif;
    text-align: center;
    background: #f5f5f5;
  }
  svg {
    background: white;
    border: 1px solid #999;
  }
  .controls {
    margin: 10px;
  }
</style>
</head>
<body>

<h2>敷き詰めアートロボット（教材版）</h2>

<div class="controls">
  図形：
  <select id="shape" onchange="redraw()">
    <option value="square">正方形</option>
    <option value="tri">正三角形</option>
    <option value="hex">六角形</option>
  </select>

  色A：
  <input type="color" id="colorA" value="#ffffff" onchange="redraw()">
  色B：
  <input type="color" id="colorB" value="#555555" onchange="redraw()">
</div>

<svg id="svg" width="500" height="500"></svg>
<p id="comment"></p>

<script>
const svg = document.getElementById("svg");
const W = 500;
const H = 500;
const NS = "http://www.w3.org/2000/svg";

function clearSVG() {
  svg.innerHTML = `<rect width="${W}" height="${H}" fill="white"/>`;
}

function color(x, y) {
  const a = document.getElementById("colorA").value;
  const b = document.getElementById("colorB").value;
  return (x + y) % 2 === 0 ? a : b;
}

function redraw() {
  clearSVG();
  const shape = document.getElementById("shape").value;
  if (shape === "hex") drawHex();
  if (shape === "tri") drawTri();
  if (shape === "square") drawSquare();
}

/* ---------- 正六角形（完全一致配置） ---------- */
function hexPoints(cx, cy, r) {
  let pts = [];
  for (let i = 0; i < 6; i++) {
    const a = Math.PI / 3 * i + Math.PI / 6;
    pts.push(cx + r * Math.cos(a) + "," + (cy + r * Math.sin(a)));
  }
  return pts.join(" ");
}

function drawHex() {
  const r = 30;
  const dx = Math.sqrt(3) * r;
  const dy = 1.5 * r;

  for (let row = 0; row < 20; row++) {
    for (let col = 0; col < 20; col++) {
      const cx = col * dx + (row % 2) * (dx / 2);
      const cy = row * dy;

      if (cx - r < 0 || cy - r < 0 || cx + r > W || cy + r > H) continue;

      const p = document.createElementNS(NS, "polygon");
      p.setAttribute("points", hexPoints(cx, cy, r));
      p.setAttribute("fill", color(col, row));
      p.setAttribute("stroke", "white");
      p.setAttribute("stroke-width", "2");
      svg.appendChild(p);
    }
  }

  document.getElementById("comment").textContent =
    "正六角形：120° × 3 = 360° → 重なりなく敷き詰め可能";
}

/* ---------- 正三角形（辺長ベース） ---------- */
function triPoints(x, y, s, up) {
  const h = Math.sqrt(3) / 2 * s;
  if (up) {
    return `${x},${y+h} ${x+s/2},${y} ${x+s},${y+h}`;
  } else {
    return `${x},${y} ${x+s},${y} ${x+s/2},${y+h}`;
  }
}

function drawTri() {
  const s = 40;
  const h = Math.sqrt(3) / 2 * s;

  for (let row = 0; row < 20; row++) {
    for (let col = 0; col < 20; col++) {
      const x = col * s;
      const y = row * h;
      const up = (row + col) % 2 === 0;

      if (x + s > W || y + h > H) continue;

      const p = document.createElementNS(NS, "polygon");
      p.setAttribute("points", triPoints(x, y, s, up));
      p.setAttribute("fill", color(col, row));
      p.setAttribute("stroke", "white");
      p.setAttribute("stroke-width", "1.5");
      svg.appendChild(p);
    }
  }

  document.getElementById("comment").textContent =
    "正三角形：60° × 6 = 360° → 重なりなく敷き詰め可能";
}

/* ---------- 正方形（元コードそのまま） ---------- */
function drawSquare() {
  const s = 40;

  for (let y = 0; y < 13; y++) {
    for (let x = 0; x < 13; x++) {
      const r = document.createElementNS(NS,"rect");
      r.setAttribute("x", x * s);
      r.setAttribute("y", y * s);
      r.setAttribute("width", s);
      r.setAttribute("height", s);
      r.setAttribute("fill", color(x, y));
      r.setAttribute("stroke", "white");
      r.setAttribute("stroke-width", "2");
      svg.appendChild(r);
    }
  }

  document.getElementById("comment").textContent =
    "正方形：90° × 4 = 360° → 完全敷き詰め";
}

redraw();
</script>

</body>
</html>
