<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>正多角形の敷き詰め 完成版</title>
<style>
  body {
    font-family: sans-serif;
    text-align: center;
    background: #f5f5f5;
  }
  svg {
    background: white;
    border: 1px solid #999;
  }
  .controls {
    margin: 10px;
  }
</style>
</head>
<body>

<h2>正多角形は平面を敷き詰められる？</h2>

<div class="controls">
  図形：
  <select id="shape" onchange="draw()">
    <option value="3">正三角形</option>
    <option value="4">正方形</option>
    <option value="5">正五角形</option>
    <option value="6">正六角形</option>
    <option value="other">その他</option>
  </select>

  集める枚数：
  <input type="number" id="count" value="3" min="1" max="8" onchange="draw()" style="width:50px">
</div>

<svg id="svg" width="320" height="320"></svg>

<p id="comment"></p>

<script>
const svg = document.getElementById("svg");
const size = 200;   // 1cm相当
const margin = 60;
const cx = margin + size / 2;
const cy = margin + size / 2;

function clear() {
  svg.innerHTML = "";
}

function frame() {
  const r = document.createElementNS("http://www.w3.org/2000/svg","rect");
  r.setAttribute("x", margin);
  r.setAttribute("y", margin);
  r.setAttribute("width", size);
  r.setAttribute("height", size);
  r.setAttribute("fill", "#eee");
  r.setAttribute("stroke", "black");
  r.setAttribute("stroke-width", 2);
  svg.appendChild(r);
}

function polygonPoints(n, r, rot, dx, dy) {
  let pts = [];
  for (let i = 0; i < n; i++) {
    const a = 2 * Math.PI * i / n - Math.PI / 2 + rot;
    pts.push(
      cx + dx + r * Math.cos(a) + "," +
      (cy + dy + r * Math.sin(a))
    );
  }
  return pts.join(" ");
}

function drawPolygon(n, r, rot, dx, dy, stroke = 2) {
  const p = document.createElementNS("http://www.w3.org/2000/svg","polygon");
  p.setAttribute("points", polygonPoints(n, r, rot, dx, dy));
  p.setAttribute("fill", "#90caf9");
  p.setAttribute("stroke", "black");
  p.setAttribute("stroke-width", stroke);
  svg.appendChild(p);
}

function drawAngleText(text) {
  const t = document.createElementNS("http://www.w3.org/2000/svg","text");
  t.setAttribute("x", cx);
  t.setAttribute("y", margin - 15);
  t.setAttribute("text-anchor", "middle");
  t.setAttribute("font-size", "14");
  t.textContent = text;
  svg.appendChild(t);
}

function draw() {
  clear();
  frame();

  const shapeVal = document.getElementById("shape").value;
  const k = parseInt(document.getElementById("count").value, 10);

  if (shapeVal === "other") {
    comment.textContent =
      "正三角形・正方形・正六角形以外の正多角形は、どの枚数でも360°にならず、敷き詰めできません。";
    return;
  }

  const n = parseInt(shapeVal, 10);
  const angle = (n - 2) * 180 / n;      // 内角
  const total = angle * k;

  // 中心角まわりに配置（敷き詰め試行）
  const r = 55;
  for (let i = 0; i < k; i++) {
    const rot = i * angle * Math.PI / 180;
    drawPolygon(n, r, rot, 0, 0, i === 0 ? 4 : 2);
  }

  drawAngleText(`内角：${angle.toFixed(1)}° ／ 合計：${total.toFixed(1)}°`);

  if (Math.abs(total - 360) < 0.01) {
    comment.textContent =
      `内角 ${angle.toFixed(1)}° × ${k} = 360° → 敷き詰め可能`;
  } else {
    comment.textContent =
      `内角 ${angle.toFixed(1)}° × ${k} = ${total.toFixed(1)}° → 360°にならず敷き詰め不可`;
  }
}

draw();
</script>

</body>
</html>
