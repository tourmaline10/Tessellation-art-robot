<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>敷き詰めアートロボット</title>
<style>
  body {
    font-family: sans-serif;
    text-align: center;
    background: #f5f5f5;
  }
  svg {
    background: white;
    border: 1px solid #999;
  }
  .controls {
    margin: 10px;
  }
</style>
</head>
<body>

<h2>敷き詰めアートロボット（教材版）</h2>

<div class="controls">
  図形：
  <select id="shape" onchange="redraw()">
    <option value="hex">六角形</option>
    <option value="tri">正三角形</option>
    <option value="square">正方形</option>
  </select>

  色A：
  <input type="color" id="colorA" value="#ffffff" onchange="redraw()">

  色B：
  <input type="color" id="colorB" value="#555555" onchange="redraw()">
</div>

<svg id="svg" width="500" height="500"></svg>
<p id="comment"></p>

<script>
const svg = document.getElementById("svg");
const W = 500;
const H = 500;
const NS = "http://www.w3.org/2000/svg";

function clearSVG() {
  svg.innerHTML = `<rect width="${W}" height="${H}" fill="white"/>`;
}

function color(x, y) {
  const a = document.getElementById("colorA").value;
  const b = document.getElementById("colorB").value;
  return (x + y) % 2 === 0 ? a : b;
}

function redraw() {
  clearSVG();
  const shape = document.getElementById("shape").value;
  if (shape === "hex") drawHex();
  if (shape === "tri") drawTri();
  if (shape === "square") drawSquare();
}

/* ---------- 六角形（重なりなし） ---------- */
function hexPoints(cx, cy, r) {
  let pts = [];
  for (let i = 0; i < 6; i++) {
    const a = Math.PI / 3 * i + Math.PI / 6;
    pts.push(cx + r * Math.cos(a) + "," + (cy + r * Math.sin(a)));
  }
  return pts.join(" ");
}

function drawHex() {
  const r = 40;
  const w = 1.5 * r;
  const h = Math.sqrt(3) * r;

  for (let y = 0; y < 10; y++) {
    for (let x = 0; x < 10; x++) {
      const cx = x * w + ((y % 2) * w / 2);
      const cy = y * h * 0.75;

      if (cx - r < 0 || cy - r < 0 || cx + r > W || cy + r > H) continue;

      const p = document.createElementNS(NS,"polygon");
      p.setAttribute("points", hexPoints(cx, cy, r));
      p.setAttribute("fill", color(x, y));
      p.setAttribute("stroke", "white");
      p.setAttribute("stroke-width", "2");
      svg.appendChild(p);
    }
  }

  document.getElementById("comment").textContent =
    "正六角形は 120°×3 = 360° となり、重なりなく敷き詰められます。";
}

/* ---------- 正三角形（重なりなし） ---------- */
function triPoints(cx, cy, r, up) {
  let pts = [];
  for (let i = 0; i < 3; i++) {
    const a =
      (up ? 0 : Math.PI) +
      i * 2 * Math.PI / 3 -
      Math.PI / 2;
    pts.push(cx + r * Math.cos(a) + "," + (cy + r * Math.sin(a)));
  }
  return pts.join(" ");
}

function drawTri() {
  const r = 30;
  const h = Math.sqrt(3) * r;

  for (let y = 0; y < 15; y++) {
    for (let x = 0; x < 15; x++) {
      const cx = x * r;
      const cy = y * h / 2;
      const up = (x + y) % 2 === 0;

      if (cx - r < 0 || cy - r < 0 || cx + r > W || cy + r > H) continue;

      const p = document.createElementNS(NS,"polygon");
      p.setAttribute("points", triPoints(cx, cy, r, up));
      p.setAttribute("fill", color(x, y));
      p.setAttribute("stroke", "white");
      p.setAttribute("stroke-width", "1.5");
      svg.appendChild(p);
    }
  }

  document.getElementById("comment").textContent =
    "正三角形は 60°×6 = 360° となり、重なりなく敷き詰められます。";
}

/* ---------- 正方形（そのまま） ---------- */
function drawSquare() {
  const s = 40;

  for (let y = 0; y < 13; y++) {
    for (let x = 0; x < 13; x++) {
      const r = document.createElementNS(NS,"rect");
      r.setAttribute("x", x * s);
      r.setAttribute("y", y * s);
      r.setAttribute("width", s);
      r.setAttribute("height", s);
      r.setAttribute("fill", color(x, y));
      r.setAttribute("stroke", "white");
      r.setAttribute("stroke-width", "2");
      svg.appendChild(r);
    }
  }

  document.getElementById("comment").textContent =
    "正方形は 90°×4 = 360° となり、完全に敷き詰められます。";
}

redraw();
</script>

</body>
</html>
